<!DOCTYPE html>
<html>
<head>
    <title>Fix Frontend API Calls</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .check { margin: 10px 0; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 5px; overflow-x: auto; }
        .step { background: #e9ecef; padding: 15px; margin: 15px 0; border-left: 4px solid #007bff; }
    </style>
</head>
<body>
    <h1>üîß Fix Frontend API Calls</h1>
    
    <div class="check success">
        <h3>‚úÖ API Working Confirmed:</h3>
        <p><strong>API Endpoint:</strong> <code>https://darbhangatravels.com/api/admin/bookings.php</code></p>
        <p><strong>Status:</strong> Working perfectly (13 bookings found)</p>
        <p><strong>Response:</strong> JSON data with success: true</p>
    </div>

    <div class="check error">
        <h3>‚ùå Frontend Issue:</h3>
        <p><strong>Problem:</strong> Frontend calling wrong URL</p>
        <ul>
            <li>Frontend calls: <code>/api/admin/bookings/</code> (without .php)</li>
            <li>API works on: <code>/api/admin/bookings.php</code> (with .php)</li>
        </ul>
    </div>

    <div class="step">
        <h3>üõ†Ô∏è Solution 1: Update .htaccess (Recommended)</h3>
        <p><strong>Update <code>public_html/api/.htaccess</code> to handle both URLs:</strong></p>
        <pre>RewriteEngine On

# Handle trailing slash - redirect to .php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ $1.php [NC,L]

# Remove .php extension for clean URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# CORS headers
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "Content-Type, Authorization"

# Handle OPTIONS requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Allow all files
&lt;Files "*"&gt;
    Order allow,deny
    Allow from all
&lt;/Files&gt;</pre>
    </div>

    <div class="step">
        <h3>üõ†Ô∏è Solution 2: Update Frontend Code</h3>
        <p><strong>Alternative: Update frontend to call .php URLs</strong></p>
        <p>Change all API calls from:</p>
        <pre>/api/admin/bookings/</pre>
        <p>To:</p>
        <pre>/api/admin/bookings.php</pre>
    </div>

    <div class="step">
        <h3>üß™ Test After Fix:</h3>
        <p><strong>Test these URLs:</strong></p>
        <ul>
            <li><code>https://darbhangatravels.com/api/admin/bookings/</code> - Should work</li>
            <li><code>https://darbhangatravels.com/api/admin/bookings.php</code> - Should work</li>
            <li><code>https://darbhangatravels.com/admin/bookings/</code> - Should load admin panel</li>
        </ul>
    </div>

    <div class="check info">
        <h3>üìã Quick Fix Steps:</h3>
        <ol>
            <li>Update <code>public_html/api/.htaccess</code> with new rules</li>
            <li>Test <code>/api/admin/bookings/</code> URL</li>
            <li>Check admin panel functionality</li>
            <li>Test booking save functionality</li>
        </ol>
    </div>

    <div class="check success">
        <h3>üéØ Expected Result:</h3>
        <p>After fixing .htaccess:</p>
        <ul>
            <li>‚úÖ <code>/api/admin/bookings/</code> will work</li>
            <li>‚úÖ Admin panel will load data properly</li>
            <li>‚úÖ No more raw JSON display</li>
            <li>‚úÖ Booking save functionality working</li>
        </ul>
    </div>

    <div class="check warning">
        <h3>‚ö†Ô∏è Current Status:</h3>
        <ul>
            <li>‚úÖ Database: Working (13 bookings)</li>
            <li>‚úÖ API: Working (bookings.php)</li>
            <li>‚ùå Frontend: Wrong URL calls</li>
            <li>‚ùå .htaccess: Not handling trailing slash</li>
        </ul>
    </div>
</body>
</html>

 

















